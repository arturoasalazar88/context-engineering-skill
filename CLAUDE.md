# Context Engineering Skill - Agent Context

<metadata>
  <project>context-engineering-skill</project>
  <components>skill, commands, templates, docs</components>
  <last_updated>2026-02-15</last_updated>
</metadata>

> **START HERE**: Load [context/stories/INDEX.md](context/stories/INDEX.md) for active tasks.

---

## Components

| Component | Purpose | Location |
|-----------|---------|----------|
| Skill Commands | 5 slash commands for Claude Code | .claude/commands/ |
| Templates | Template files for project initialization | templates/ |
| Documentation | Comprehensive guides and references | docs/ |
| Installer | Automated installation script | install.sh |

---

## Context Files (Load as Needed)

| File | Purpose | Load When |
|------|---------|-----------|
| **context/stories/INDEX.md** | **Active tasks & progress** | **ALWAYS first** |
| context/SYSTEM.md | Server info & credentials | SSH, checking status |
| context/MEMORY-PROTOCOL.md | Memory management guide | Managing memory layers |
| context/workflows/*.md | Detailed workflow rules | Per workflow need |
| context/stories/SESSION-LOG.md | Historical sessions | Reviewing past work |
| docs/context-engineering-guide.md | Core principles & philosophy | Understanding methodology |
| docs/commands-reference.md | Detailed command specs | Understanding command behavior |
| docs/rules-reference.md | Rules catalog | Adding/customizing rules |
| docs/memory-layers.md | 4-layer memory architecture | Deep dive on memory system |
| docs/bugs/*.md | Bug reports with fix manifests | Applying fixes, understanding issues |

---

## Context Loading Tiers

| Tier | What | When | Budget |
|------|------|------|--------|
| Always | CLAUDE.md, core-rules.md | Every session | ~2K tokens |
| Mandatory | Workflows with ðŸ”’ markers | Auto-loaded at session start | ~3K tokens |
| Start | stories/INDEX.md | Session start | ~1K tokens |
| Task | Active story + relevant context | Starting specific task | ~3K tokens |
| Demand | Workflow rules, troubleshooting, etc. | When specific need arises | ~5K tokens |
| Archive | DONE-* stories, session log | Only for historical review | ~2K tokens |

> **Schema:** `context/CONTEXT-SCHEMA.yaml`

---

## Core Rules

1. **NEVER mark tasks resolved without explicit user approval**
2. **ALWAYS present summary + evidence before requesting resolution**
3. **ALWAYS load stories/INDEX.md at session start**
4. **NEVER store secrets/passwords in CLAUDE.md or context files** (use SYSTEM.md)
5. **ALWAYS update story files at task milestones**
6. **ALWAYS follow context engineering principles** (see `.claude/rules/context-enforcement.md`)
7. **MONITOR context window usage** - Report at key points, end session before compaction
8. **ALL code must be generated by Claude Code agent** - No manual code edits

> **Detailed rules:** `.claude/rules/core-rules.md` (auto-loaded) -> `context/workflows/` (load on demand)

---

## How to Use This Context System

**At Session Start:**
1. You automatically load: CLAUDE.md + .claude/rules/*.md (~2K tokens)
2. /context-start scans context/workflows/ and auto-loads files with ðŸ”’ MANDATORY markers (~3K tokens)
3. ALWAYS read context/stories/INDEX.md next
4. Load active story file for task being worked on

**During Work:**
- Mandatory workflows (ðŸ”’) are already loaded and must be followed
- Load additional workflow rules from context/workflows/ ONLY when needed
- Load domain files (docs/) only when task requires them
- Check Context Loading Tiers table if unsure what to load

**Monitor Context Window:**
- Report usage at session start
- Check after completing stories/tasks
- Watch for Yellow zone (100K+) and Red zone (140K+) warnings
- End session proactively before 160K token limit

**At Session End:**
- Report final token usage
- Update story file with progress
- Add key learnings below if significant
- Prune verbose tool outputs from conversation (keep conclusions)

---

## Key Learnings

| Date | Learning |
|------|----------|
| 2026-02-15 | coding-sub-agent.md: Mandatory workflow uses Gemini CLI for code gen (60-70% token savings) |
| 2026-02-14 | BUG-001: /context-start must scan context/workflows/ for mandatory workflows (ðŸ”’ markers) |
| 2026-02-14 | All MD files in this repo are critical context - docs, commands, templates, bug reports |
| 2026-02-14 | Development is 100% Claude Code generated - no manual edits to maintain consistency |

---

## Current Priorities

See [context/stories/INDEX.md](context/stories/INDEX.md) for active priorities and backlog.

---

## Quick Reference

```bash
# Start session
/context-start

# Add new context
/context-ingest

# Refactor existing context
/context-refactor

# Apply bug fixes
/context-update
```
